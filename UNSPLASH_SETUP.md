# Настройка Unsplash API для изображений товаров

## Обзор

Система автоматически получает разные изображения из Unsplash для каждого товара на основе:
- Категории товара
- Названия товара (ключевые слова)
- Fallback изображения для каждой категории

## Настройка API ключа

1. Зарегистрируйтесь на [Unsplash Developers](https://unsplash.com/developers)
2. Создайте новое приложение
3. Получите Access Key
4. Добавьте ключ в переменные окружения:

```env
NEXT_PUBLIC_UNSPLASH_ACCESS_KEY=your_unsplash_access_key_here
```

## Структура системы

### Категории товаров

Система поддерживает следующие категории:
- `electronics` - электроника (телефоны, ноутбуки, гаджеты)
- `clothing` - одежда (фэшн, рубашки, платья, обувь)
- `furniture` - мебель (стулья, столы, диваны, декор)
- `cars` - автомобили (машины, транспорт)
- `real_estate` - недвижимость (дома, квартиры, интерьеры)
- `services` - услуги (бизнес, офис, профессионалы)
- `kids` - детские товары (игрушки, дети, младенцы)
- `goods` - общие товары (продукты, предметы)

### Функции API

#### `getProductImages(productTitle, category, count)`
Получает изображения на основе названия товара и категории:
- Извлекает ключевые слова из названия
- Ищет изображения по ключевым словам
- Дополняет изображениями из категории
- Убирает дубликаты
- Возвращает указанное количество изображений

#### `getCategoryImages(category, count)`
Получает изображения по категории:
- Использует предустановленные запросы для каждой категории
- Кэширует результаты для оптимизации
- Возвращает fallback изображения при ошибках

#### `getUnsplashImage(query, width, height)`
Базовая функция для получения одного изображения по запросу.

## Использование в компонентах

### Хук useProductImages

```typescript
import { useProductImages } from "@/lib/hooks/useProductImages";

const { images, loading, error } = useProductImages({
  productTitle: "iPhone 14 Pro Max 256GB",
  category: "electronics",
  count: 3
});
```

### Компонент ProductCard

Компонент автоматически использует хук для загрузки изображений:

```typescript
<ProductCard product={product} />
```

Где `product` должен содержать:
- `title` - название товара
- `category` - категория товара

## Fallback система

Если API недоступен или возвращает ошибки, система использует предустановленные изображения:

1. **Fallback по категориям** - для каждой категории есть набор качественных изображений
2. **Обработка ошибок** - если изображение не загружается, автоматически переключается на следующее
3. **Индикаторы загрузки** - показывают состояние загрузки изображений

## Кэширование

Система использует in-memory кэш для оптимизации:
- Кэширует результаты по категориям
- Очищает кэш при необходимости
- Уменьшает количество запросов к API

## Ограничения Unsplash API

- **Demo приложения**: 50 запросов в час
- **Production приложения**: 5000 запросов в час
- **Rate limiting**: соблюдайте лимиты для стабильной работы

## Мониторинг

Для отслеживания использования API добавьте логирование:

```typescript
// В unsplash.ts
console.log('Unsplash API requests:', requestCount);
```

## Безопасность

- Никогда не коммитьте API ключи в репозиторий
- Используйте переменные окружения
- Ограничьте доступ к API ключу только необходимыми правами

## Примеры использования

### Получение изображений для товара

```typescript
const product = {
  title: "MacBook Air M2 13-inch",
  category: "electronics"
};

const { images, loading, error } = useProductImages({
  productTitle: product.title,
  category: product.category,
  count: 3
});
```

### Прямой вызов API

```typescript
import { getProductImages } from "@/lib/unsplash";

const images = await getProductImages(
  "iPhone 14 Pro Max", 
  "electronics", 
  3
);
```

## Troubleshooting

### Проблема: Изображения не загружаются
**Решение**: Проверьте API ключ и лимиты запросов

### Проблема: Медленная загрузка
**Решение**: Используйте кэширование и оптимизируйте размеры изображений

### Проблема: Неподходящие изображения
**Решение**: Улучшите ключевые слова в названиях товаров